---
bibliography: references.bib
csl: chicago.csl
output: github_document
---

```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.width = 6,
  fig.asp = 0.618,
  out.width = "70%",
  fig.align = "center",
  dpi = 300
)
options(scipen = 999, digits = 4)
knitr::knit_hooks$set(
  inline = function(x) {
    if (is.numeric(x)) {
      return(formatC(x, big.mark = ",", format = "fg", digits = 2))
    } else{
      return(x)
    }
  }
)
```

```{r}
# libraries
library(tidyverse)
library(here)
library(cowplot)
```

## Results

### Uptake

```{r}
els_jns_df <- readr::read_csv(here::here("data", "elsevier_apc_list.csv"))
els_jns <- readr::read_csv(here::here("data", "els_historic_jns.csv")) 
els_jns_count <- els_jns %>%
  group_by(year, oa_model) %>%
  count(year) %>%
  group_by(year) %>%
  mutate(prop = n / sum(n)) %>%
  mutate(oa_model_fct = fct_rev(as_factor(oa_model))) 
```

#### How many Elsevier journals supported the hybrid model?

```{r}
els_overall <- els_jns %>% 
  group_by(oa_model) %>% 
  summarise(n = n_distinct(issn))
```

Using text-mined data from web-archived Elsevier APC pricing lists  [@Matthias_2020], we were able to determine the evolution of Elsevier's open access journal portfolio. Figure shows that the majority of journals supported the hybrid model. Overall, Elsevier published `r length(unique(els_jns$issn))` open access journals, of which `r els_jns %>%  filter(oa_model == "Hybrid") %>% distinct(issn) %>% nrow()` supported the hybrid model.

Elsevier's journal portfolio changed over the period of observation. The number of hybrid journals grew by  `r (els_jns_count %>% filter(oa_model == "Hybrid", year == 2020) %>% .$n) - (els_jns_count %>% filter(oa_model == "Hybrid", year == 2015) %>% .$n)` journals between 2015 and May 2020, while its proportion relative to Elsevier's overall journal portfolio slightly decreased from `r round(els_jns_count %>% filter(oa_model == "Hybrid", year == 2015) %>% .$prop, 2) * 100`% to `r round(els_jns_count %>% filter(oa_model == "Hybrid", year == 2020) %>% .$prop, 2) * 100`%. The year 2016 marked the highest number of journals. After that, the trend reversed. Since 2018, the number of journals stagnated. On 23 May 2020, Elsevier APC pricing list comprised `r length(unique(els_jns_df$issn))` journals, of which `r els_jns_df %>% filter(oa_type == "Hybrid") %>% distinct(issn) %>% nrow()` supported the hybrid model, representing a share of `r round(els_jns_df %>% filter(oa_type == "Hybrid") %>% distinct(issn) %>% nrow() / length(unique(els_jns_df$issn)) * 100, 0)`%.

```{r}
ggplot(els_jns_count,
       aes(as.character(year), n,  fill = oa_model_fct, group = oa_model_fct)) +
  geom_area(alpha = 0.8,
            colour = "white") +
  scale_fill_manual(
    values = c("#cccccca0", "#56b4e9"),
    name = NULL,
    labels = c("Fully", "Hybrid")
  ) +
  labs(x = "Year", y = "Elsevier Journals") +
  scale_y_continuous(
    labels = scales::number_format(big.mark = ","),
    expand = expansion(mult = c(0, 0.05)),
    breaks =  scales::extended_breaks()
  ) +
  theme_minimal_hgrid() +
  theme(legend.position = "top",
        legend.justification = "right") +
  guides(fill = guide_legend("OA Business Model"))
```

#### How many of hybrid journals flipped to fully open access? 

```{r}
flipped_jns <- els_jns %>%
  distinct(issn, oa_model) %>%
  group_by(issn) %>%
  filter(n() > 1)
flipped_jns_ind <- els_jns %>%
  filter(issn %in% flipped_jns$issn) %>%
  group_by(issn) %>%
  slice(which.max(year)) %>%
  ungroup() %>%
  count(oa_model)
```

Following the approach of our earlier study [@Matthias_2019], we started with APC pricing list information to determine the number of open access business model flips between 2015-2020. Although the transition from hybrid to a fully open access business model has drawn most attention, also the reverse can be observed. A total number of `r sum(flipped_jns_ind$n)` journals changed the business model under the ownership of Elsevier. Of these, `r filter(flipped_jns_ind, oa_model == "Open Access")$n` journals flipped to fully open access, while `r filter(flipped_jns_ind, oa_model != "Open Access")$n` changed to hybrid open access. Examples for such reverse flipped open access journals include the physical journal *Materials Today* and the life science journal *Meta Gene*.

#### What is the uptake of open access in Elsevier's current hybrid journal portfolio?

*Number and percentage of journals with at least one article*

```{r}
els_jns_df <- readr::read_csv(here::here("data", "elsevier_apc_list.csv"))
```

```{r}
# paratext pattern
para <- c('^Author Index$|^Back Cover|^Contents$|^Contents:|^Cover Image|^Cover Picture|^Editorial Board|^Front Cover|^Frontispiece|^Inside Back Cover|^Inside Cover|^Inside Front Cover|^Issue Information|^List of contents|^Masthead|^Title page')
```

```{r}
hybrid_md <- readr::read_csv(here::here("data", "hybrid_md.csv"))
els_tdm <- readr::read_csv(here::here("data", "els_tmd_links.csv"))
invoice_df <-  readr::read_csv(here::here("data", "invoice_df.csv"))

hybrid_df <- els_tdm %>% 
  select(doi, URL) %>% 
  inner_join(invoice_df, by = c("URL" = "tdm_url")) %>% 
  select(-URL) %>% 
  inner_join(hybrid_md, by = c("doi")) %>% 
  distinct() %>%
  filter(!grepl(para, title))

flipped_jns_df <-
  els_jns %>%
    filter(issn %in% flipped_jns$issn)
```

To determine the number of Elsevier hybrid journals with at least one open access article, we focused on the most current version of Elsevier's APC pricing list, lastly updated on 23 May 2020 [@Matthias_2020]. We used the Crossref index to determine the overall article volume of Elsevier's hybrid journal portfolio, and related it to the number of open access articles indicated by Creative Commons licenses. We only considered open access articles that were provided without delay, which we determined from mined full-text metadata. Because Elsevier also issued DOIs to non-scholarly journal content including table of contents and list of reviewers, we excluded these records using Unpaywall's paratext recognition approach [^1]. They account for about 2.5% of DOIs registered by Crossref.

[^1]: <https://support.unpaywall.org/support/solutions/articles/44001894783-what-does-is-paratext-mean-in-the-api->

On 23 May 2020, Elsevier APC pricing list comprised `r els_jns_df %>% filter(oa_type == "Hybrid") %>% distinct(issn) %>% nrow()` journals that supported the hybrid model. Of those, `r hybrid_df %>% filter(oa_archive == FALSE) %>% distinct(issn) %>% nrow()` hybrid journals published at least one open access article under a Creative Commons license between 2015 and 2019, corresponding to about `r round(hybrid_df %>% filter(oa_archive == FALSE) %>% distinct(issn) %>% nrow() / els_jns_df %>% filter(oa_type == "Hybrid") %>% nrow() * 100, 0)`% of journal titles in Elsevierâ€™s hybrid journal portfolio. At the same time, `r 100 - round(hybrid_df %>% filter(oa_archive == FALSE) %>% distinct(issn) %>% nrow() / els_jns_df %>% filter(oa_type == "Hybrid") %>% nrow() * 100, 0)`% of hybrid journals did not published an open access article.

```{r}
eligible_jns <- hybrid_df %>% 
  filter(oa_archive == FALSE) %>% 
  distinct(issn)
```

*Number and percentage of immediate open access articles per hybrid journal*

```{r}
# required data spreadsheets
# pub volume
els_pub_volume <- readr::read_csv(
  here::here("data", "article_volume_para.csv")
  ) 
# eligble journals 
eligible_jns <- hybrid_df %>% 
  filter(oa_archive == FALSE) %>% 
  distinct(issn)
# pub volume eligble data
els_yr <- els_pub_volume %>%
  filter(issn %in% eligible_jns$issn) %>%
  group_by(issued_year) %>%
  summarise(articles = sum(articles),
            journals = n_distinct(issn))

# oa
ind_per_year <- hybrid_df %>%
  filter(oa_archive == FALSE) %>%
  group_by(issued_year) %>%
  summarise(oa_articles = n()) %>%
  inner_join(els_yr, by = "issued_year") %>%
  ungroup() %>%
  mutate(prop = oa_articles / articles * 100)
ind_summary_table <- ind_per_year %>% 
  pivot_longer(oa_articles:prop, names_to = "indicator", values_to = "count") %>%
  pivot_wider(names_from = issued_year, values_from = count) %>%
  mutate(indicator = factor(indicator, levels = c("journals", "articles", "oa_articles", "prop"))) %>%
  arrange(indicator) %>%
  mutate(indicator = recode(indicator,
                            oa_articles = "Hybrid OA Articles", 
                            articles = "All Articles", 
                            journals = "Hybrid journals with at least one OA article", 
                            prop = "Percentage"))
`Total` <- c(
  hybrid_df %>% filter(oa_archive == FALSE) %>% distinct(issn) %>% nrow(),
  sum(ind_summary_table[2,2:6]),
  sum(ind_summary_table[3,2:6]),
  sum(ind_per_year$oa_articles) / sum(ind_per_year$articles) * 100)
uptake_table <- bind_cols(ind_summary_table, Total = `Total`) %>%
  rename(` ` = indicator) %>%
  knitr::kable(digits = 1)
```

Overall, `r Total[1]` hybrid journals provided immediate open access to `r Total[3]` articles between 2015 and 2019. The total share of hybrid open access in the publication volume of Elsevier journals was `r Total[4]`%. Table present the high-level findings by year, illustrating a moderate growth in hybrid open access. Although the number of hybrid journals with at least one open access article remained somehow constant, the number of open access articles rose substantially from `r ind_per_year %>% filter(issued_year == 2015) %>% pull(oa_articles)` (2015) to `r ind_per_year %>% filter(issued_year == 2019) %>% pull(oa_articles)` (2019). However, the overall uptake of open access in Elsevier's hybrid journal portfolio grew slowly from `r ind_per_year %>% filter(issued_year == 2015) %>% pull(prop)`% (2015) to `r ind_per_year %>% filter(issued_year == 2019) %>% pull(prop)`% (2019), because the number of articles published also increased during this five-years period.

```{r}
uptake_table
```

```{r}
els_jn_pub_volume <- els_pub_volume %>%
  filter(issn %in% eligible_jns$issn) %>%
  group_by(issued_year, issn) %>%
  summarise(articles = sum(articles),
            journals = n_distinct(issn))
hybrid_oa_per_jn <- hybrid_df %>%
  filter(oa_archive == FALSE) %>%
  group_by(issued_year, issn) %>%
  summarise(oa_articles = n())%>%
  inner_join(els_jn_pub_volume, by = c("issued_year", "issn")) %>%
  ungroup() %>%
  mutate(prop = oa_articles / articles * 100) %>% View()
```

The open access share varied across Elsevier hybrid journals. Since 2015, most hybrid journals have had a slow uptake rate of open access articles. In general, open access via the hybrid open access publishing model played a marginal role in the context of Elsevierâ€™s total publication volume.



# license



